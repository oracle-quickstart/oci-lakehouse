title: Data Lakehouse on OCI
schemaVersion: 1.1.0
version: "20220106"
locale: "en"
groupings:
- title: "Data Lakehouse Components"
  variables: 
  - deploy_ADB
  - deploy_BDS
  - deploy_data_catalog
  - deploy_data_integration
  - deploy_MySQL
  - deploy_streaming
- title: "VCN Options"
  variables:
  - useExistingVcn
  - availability_domain
  - myVcn
  - vcn_dns_label
  - custom_cidrs
  - VCN_CIDR
  - edge_cidr
  - private_cidr
- title: "Autonomous Data Warehouse Options"
  variables: 
  - autonomous_database_db_name
  - autonomous_database_admin_password
  - autonomous_database_cpu_core_count
  - is_autonomous_dedicated
  - autonomous_database_data_storage_size_in_gb
  - autonomous_database_data_storage_size_in_tbs
  - autonomous_database_display_name
  - autonomous_database_is_preview_version_with_service_terms_accepted
  visible: deploy_ADB
- title: "Big Data Service Options"
  variables:
  - bds_instance_cluster_admin_password
  - bds_instance_cluster_public_key
  - bds_instance_cluster_version
  - bds_instance_display_name
  - bds_instance_is_high_availability
  - bds_instance_is_secure
  - master_shape
  - master_display_name
  - master_block_volume_size_in_gbs
  - data_shape
  - data_display_name
  - data_node_qty
  - data_block_volume_size_in_gbs
  - util_shape
  - util_display_name
  - util_block_volume_size_in_gbs
  - bds_instance_network_config_cidr_block
  - bds_instance_network_config_is_nat_gateway_required
  - auto_scaling_configuration_cluster_admin_password
  - auto_scaling_configuration_is_enabled
  - auto_scaling_configuration_policy_policy_type
  - auto_scaling_configuration_policy_rules_action
  - auto_scaling_configuration_policy_rules_metric_metric_type
  - auto_scaling_configuration_policy_rules_metric_threshold_duration_in_minutes
  - auto_scaling_configuration_policy_rules_metric_threshold_operator
  - auto_scaling_configuration_policy_rules_metric_threshold_value
  - auto_scaling_configuration_display_name
  visible: deploy_BDS
- title: "Data Catalog Options"
  variables:
  - catalog_display_name
  visible: deploy_data_catalog
- title: "Data Integration Options"
  variables:
  - workspace_display_name
  - workspace_description 
  visible: deploy_data_integration
- title: "MySQL Heatwave Options"
  variables:
  - mysql_db_system_admin_username
  - mysql_db_system_admin_password
  - mysql_shape_name
  - heat_wave_cluster_cluster_size
  - mysql_db_system_data_storage_size_in_gb
  - mysql_db_system_description
  - mysql_db_system_display_name
  - mysql_db_system_hostname_label
  visible: deploy_MySQL
- title: "Streaming Options"
  variables:
  - connect_harness_name
  - stream_name
  - stream_partitions
  - stream_pool_name
  - stream_retention_in_hours
  - stream_pool_kafka_settings_auto_create_topics_enable
  - stream_pool_kafka_settings_log_retention_hours
  - stream_pool_kafka_settings_num_partitions
  visible: deploy_streaming
- title: "Pre-Defined"
  variables:
  - region
  - compartment_ocid
  - tenancy_ocid
  - auto_scaling_configuration_node_type
  - catalog_private_endpoint_display_name
  visible: false

variables:

  deploy_ADB:
    type: boolean
    title: "Autonomous Data Warehouse"
    description: "Click to Deploy"
    required: true
    default: false
 
  deploy_BDS:
    type: boolean
    title: "Big Data Service"
    description: "Click to Deploy"
    required: true
    default: false

  deploy_data_catalog:
    type: boolean
    title: "Data Catalog"
    description: "Click to Deploy"
    required: true
    default: false
 
  deploy_data_integration:
    type: boolean
    title: "Data Integration"
    description: "Click to Deploy"
    required: true
    default: false

  deploy_MySQL:
    type: boolean
    title: "MySQL Heatwave"
    description: "Click to Deploy"
    required: true
    default: false

  deploy_streaming:
    type: boolean
    title: "OCI Streaming"
    description: "Click to Deploy"
    required: true
    default: false

  useExistingVcn:
    type: boolean
    title: "Use Existing VCN"
    description: "Click to use existing VCN, otherwise VCN and Subnets will be created"
    required: true
    default: false

  myVcn:
    type: oci:core:vcn:id
    title: "Existing VCN"
    description: "Select Existing VCN"
    dependsOn:
      compartmentId: compartment_ocid
    visible: useExistingVcn
    required: true

  custom_cidrs:
    type: boolean
    title: "Customize Network CIDRS"
    description: "Click to customize CIDR ranges, only applicable when creating VCN as part of deployment"
    required: true
    default: false
    visible:
      not:
        - useExistingVcn

  privateSubnet:
    type: oci:core:subnet:id
    title: "Private Subnet"
    description: "Select Private Subnet"
    dependsOn:
      compartmentId: compartment_ocid
      vcnId: myVcn
    visible: useExistingVcn
    required: true

  edgeSubnet:
    type: oci:core:subnet:id
    title: "Edge Subnet"
    description: "Select Edge (Public) Subnet"
    dependsOn:
      compartmentId: compartment_ocid
      vcnId: myVcn
    visible: useExistingVcn
    required: true

  availability_domain:
    type: oci:identity:availabilitydomain:name
    title: "Availability Domain"
    description: "Select AD"
    dependsOn:
      compartmentId: compartment_ocid
    required: true

  VCN_CIDR:
    type: string
    title: "VCN CIDR"
    description: "Customize VCN top level CIDR"
    visible: custom_cidrs

  edge_cidr:
    type: string
    title: "Edge Subnet CIDR"
    description: "Customize Edge Subnet CIDR, ensure this fits in VCN CIDR range."
    visible: custom_cidrs

  private_cidr:
    type: string
    title: "Private Subnet CIDR"
    description: "Customize Private Subnet CIDR, ensure this fits in VCN CIDR range."
    visible: custom_cidrs

  vcn_dns_label:
    type: string
    title: "VCN DNS Label"
    description: "Set the VCN DNS label to be used when creating VCN.  Default is 'kubeflowvcn' which sets the VCN domain to 'kubeflowvcn.oraclevcn.com'"
    visible:
      not:
        - useExistingVcn

  autonomous_database_db_name:
    type: string
    title: "Database Name"
    description: "The database name. The name must begin with an alphabetic character and can contain a maximum of 14 alphanumeric characters. Special characters are not permitted. The database name must be unique in the tenancy."
    required: true
    default: "LakehouseDB"

  autonomous_database_admin_password:
    type: password 
    title: "Admin Password"
    description: "(Updatable) The password must be between 12 and 30 characters long, and must contain at least 1 uppercase, 1 lowercase, and 1 numeric character. It cannot contain the double quote symbol (\") or the username \"admin\", regardless of casing."
    required: true
    default: ""

  autonomous_database_cpu_core_count:
    type: int
    title: "Core Count"
    description: "(Updatable) The number of OCPU cores to be made available to the database. For Autonomous Databases on dedicated Exadata infrastructure, the maximum number of cores is determined by the infrastructure shape."
    required: true
    default: "2"

  is_autonomous_dedicated:
    type: boolean
    title: "Dedicated Exadata Infrastructure"
    description: "Selecting this option will deploy the database to dedicated Exadata infrastructure.  Note that this incurs a higher cost."
    required: true
    default: false

  autonomous_database_data_storage_size_in_gb:
    type: int
    title: "Database Storage in GB"
    description: "(Updatable) The size, in gigabytes, of the data volume that will be created and attached to the database. This storage can later be scaled up if needed. The maximum storage value is determined by the infrastructure shape."
    required: true
    default: "1000"
    visible: is_autonomous_dedicated

  autonomous_database_data_storage_size_in_tbs:
    type: int
    title: "Database Storage in GB"
    description: "(Optional) (Updatable) The size, in terabytes, of the data volume that will be created and attached to the database."
    required: true
    default: "1"
    visbible:
      not:
        - is_autonomous_dedicated

  autonomous_database_display_name:    
    type: string
    title: "Database Display Name"
    description: "The user-friendly name for the Autonomous Database. The name does not have to be unique."
    required: true
    default: "LakehouseDB"

  autonomous_database_is_preview_version_with_service_terms_accepted:
    type: boolean
    title: "Use Preview Version"
    description: "Click to accept terms of service for deployment of the Autonomous Database preview version. (Optional)"
    default: false
    visible:
      not:
        - is_autonomous_dedicated

  bds_instance_cluster_admin_password:
    type: password
    title: "Admin Password"
    description: "Password for the cluster (and Cloudera Manager) admin user."
    required: true
    default: ""

  bds_instance_cluster_public_key:
    type: string
    title: "Cluster SSH Public Key"
    description: "The SSH public key used to authenticate the cluster connection."
    required: true
    default: ""

  bds_instance_cluster_version:
    type: enum
    enum:
    - "ODH1"
    title: "Cluster Version"
    description: "Version of the Hadoop distribution."
    required: true
    default: "ODH1"

  bds_instance_display_name:
    type: string
    title: "Cluster Display Name"
    description: "(Updatable) Name of the Big Data Service cluster."
    required: true
    default: "Lakehouse Cluster"

  bds_instance_is_high_availability:
    type: boolean
    title: "High Availability"
    description: "Choose whether you want High Availability (HA) cluster deployment."
    required: true
    default: false

  bds_instance_is_secure: 
    type: boolean
    title: "Cluster Security"
    description: "Choose whether you want to enable cluster security (Kerberos)."
    required: true
    default: false

  master_shape:
    type: oci:core:instanceshape:name
    title: "Master Node Shape"
    description: "Pick a shape for this node."
    required: true
    dependsOn:
      compartmentId: compartment_ocid
    default: "VM.Standard2.4"

  master_display_name:
    type: string
    title: "Master Host Display Name"
    description: "The name of the node."
    required: true
    default: "MasterNode"

  master_block_volume_size_in_gbs:
    type: int
    title: "Master Block Volume Size"
    description: "The size of block volume in GB to be attached to a given node. All the details needed for attaching the block volume are managed by service itself."
    required: true
    default: 1000

  data_shape:
    type: oci:core:instanceshape:name
    title: "Data Node Shape"
    description: "Pick a shape for this node."
    required: true
    dependsOn:
      compartmentId: compartment_ocid
    default: "VM.Standard2.1"

  data_display_name:    
    type: string
    title: "Data Node Display Name"
    description: "The name of the node."
    required: true
    default: "DataNode"

  data_node_qty:
    type: int
    title: "Number of Data Nodes"
    description: "The number of data nodes that form the cluster."
    required: true
    default: 3

  data_block_volume_size_in_gbs:
    type:
    title: "Data Block Volume Size"
    description: "The size of block volume in GB to be attached to a given node. All the details needed for attaching the block volume are managed by service itself.  Note that this size affects how much space is available in HDFS - you should scale this to more than 3x the total capacity you need."
    required: true
    default: 1000

  util_shape:
    type: oci:core:instanceshape:name
    title: "Utility Node Shape"
    description: "Pick a shape for this node."
    required: true
    dependsOn:
      compartmentId: compartment_ocid
    default: "VM.Standard2.4"

  util_display_name:
    type: string
    title: "Utility Node Display Name"
    description: "The name of the node."
    required: true
    default: "UtilNode"

  util_block_volume_size_in_gbs:
    type: int
    title: "Utility Block Volume Size"
    description: "The size of block volume in GB to be attached to a given node. All the details needed for attaching the block volume are managed by service itself."
    required: true
    default: 1000

  bds_instance_network_config_cidr_block:
    type: string
    title: "Cluster CIDR Block"
    description: "A private network is created for optimal communication across cluster nodes. Set the CIDR block for this network."
    required: true

  bds_instance_network_config_is_nat_gateway_required:
    type: boolean
    title: "Oracle-Managed NAT Gateway"
    description: "Deploy Oracle-managed Service gateway and NAT gateway (Quick Start) for your cluster.  When disabled this will use gateways in your customer VCN"
    required: true
    default: true

  auto_scaling_configuration_is_enabled:
    type: boolean
    title: "Enable Auto-Scaling"
    description: "Whether the autoscale configuration is enabled."
    required: true
    default: false

  auto_scaling_configuration_policy_policy_type:
    type: string
    title: "Autoscaling Policy Type"
    description: "Types of autoscale policies. Options are SCHEDULE-BASED or THRESHOLD-BASED. (Only THRESHOLD-BASED is supported in this release.)"
    required: true
    default: "THRESHOLD-BASED"
    visible: auto_scaling_configuration_is_enabled

  auto_scaling_configuration_policy_rules_action:
    type: enum
    enum:
    - "CHANGE_SHAPE_SCALE_UP"
    - "CHANGE_SHAPE_SCALE_DOWN"
    title: "Autoscaling Rules Action"
    description: "(Updatable) The valid value are CHANGE_SHAPE_SCALE_UP or CHANGE_SHAPE_SCALE_DOWN."
    required: true
    default: "CHANGE_SHAPE_SCALE_UP"
    visible: auto_scaling_configuration_is_enabled

  auto_scaling_configuration_policy_rules_metric_metric_type:
    type: enum
    enum: 
    - "CPU_UTILIZATION"
    title: "Autoscaling Rules Metric Type"
    description: "(Updatable) Allowed value is CPU_UTILIZATION."
    required: true
    default: "CPU_UTILIZATION"
    visible: auto_scaling_configuration_is_enabled

  auto_scaling_configuration_policy_rules_metric_threshold_duration_in_minutes:
    type: int 
    title: "Autoscaling Threshold Duration in Minutes"
    description: "Updatable) This value is the minimum period of time the metric value meets or exceeds the threshold value before the action is triggered. The value is in minutes."
    required: true
    default: 5
    visible: auto_scaling_configuration_is_enabled

  auto_scaling_configuration_policy_rules_metric_threshold_operator: 
    type: enum
    enum:
    - "GT"
    - "LT"
    title: "Autoscaling Metric Threshold Operator"
    description: "(Updatable) The comparison operator to use. Options are greater than (GT) or less than (LT)."
    required: true
    visible: auto_scaling_configuration_is_enabled

  auto_scaling_configuration_policy_rules_metric_threshold_value:
    type: int
    title: "Autoscaling Metric Threshold Value"
    description: "(Updatable) Integer non-negative value. 0 < value < 100"
    required: true
    default: 50
    min: 1
    max: 99
    visible: auto_scaling_configuration_is_enabled

  auto_scaling_configuration_display_name:
    type: string
    title: "Autoscaling Config Display Name"
    description: "(Updatable) A user-friendly name. The name does not have to be unique, and it may be changed. Avoid entering confidential information."
    required: true
    default: "Autoscaling Config"
    visible: auto_scaling_configuration_is_enabled

  catalog_display_name:
    type: string
    title: Catalog Display Name
    description: "(Updatable) Data catalog identifier."
    default: "Data Catalog"
    required: true

  workspace_display_name:
    type: string
    title: "Workspace Display Name"
    description: "(Updatable) A user-friendly display name for the workspace. Does not have to be unique, and can be modified. Avoid entering confidential information."
    default: "Data Integration Workspace"
    required: true

  workspace_description:
    type: string
    title: "Workspace Description"
    description: "(Updatable) A user defined description for the workspace."
    default: "Default Workspace"
    required: true

  mysql_db_system_admin_password:
    type: password
    title: "Admin Passsword"
    description: "The password for the administrative user. The password must be between 8 and 32 characters long, and must contain at least 1 numeric character, 1 lowercase character, 1 uppercase character, and 1 special (nonalphanumeric) character."
    default: ""
    required: true

  mysql_db_system_admin_username:
    type: string
    title: "Admin username"
    description: "The username for the administrative user."
    default: "mysql_admin"
    required: true

  mysql_shape_name:
    type: enum
    enum:
    - "MySQL.HeatWave.VM.Standard.E3"
    - "MySQL.HeatWave.BM.Standard.E3"
    title: "Shape Selection"
    description: "Select a shape for the MySQL HeatWave cluster. (Updatable) A change to the shape of the nodes in the HeatWave cluster will result in the entire cluster being torn down and re-created with Compute instances of the new Shape. This may result in significant downtime for the analytics capability while the HeatWave cluster is re-provisioned."
    default: "MySQL.HeatWave.VM.Standard.E3"
    required: true

  heat_wave_cluster_cluster_size:
    type: int
    title: "Cluster Size"
    description: "The number of analytics-processing compute instances, of the specified shape, in the HeatWave cluster."
    default: 2
    min: 2
    required: true

  mysql_db_system_data_storage_size_in_gb:
    type: int
    title: "Database Storage Size"
    description: "Initial size of the data volume in GBs that will be created and attached. Keep in mind that this only specifies the size of the database data volume, the log volume for the database will be scaled appropriately with its shape."
    default: 50
    min: 50
    required: true

  mysql_db_system_description:
    type: string
    title: "Database Description"
    description: "(Updatable) User-provided data about the DB System."
    default: "HeatWave Database"
    required: true

  mysql_db_system_display_name:
    type: string
    title: "Database Display Name"
    description: "(Updatable) The user-friendly name for the DB System. It does not have to be unique."
    default: "Heatwave Database"
    required: true

  mysql_db_system_hostname_label:
    type: string
    title: "Database Hostname Label"
    description: "The hostname for the primary endpoint of the DB System. Used for DNS.  The value is the hostname portion of the primary private IP's fully qualified domain name (FQDN) (for example, \"heatwave-1\" in FQDN \"heatwave-1.private.lakehousevcn.oraclevcn.com\"). Must be unique across all VNICs in the subnet and comply with RFC 952 and RFC 1123."
    default: "heatwave-1"
    required: true

  connect_harness_name:
    type: string
    title: "Connect Harness Name"
    description: "The name of the connect harness. Avoid entering confidential information. Example: JDBCConnector"
    default: "JDBCConnector"
    required: true

  stream_name:
    type: string
    title: "Stream Name"
    description: "The name of the stream. Avoid entering confidential information. Example: TelemetryEvents"
    default: "DefaultStream"
    required: true

  stream_partitions:
    type: int
    title: "Stream Partitions"
    description: "The number of partitions in the stream."
    default: 1
    min: 1
    required: true

  stream_retention_in_hours:
    type: int
    title: "Stream Retention in Hours"
    description: "The retention period of the stream, in hours. Accepted values are between 24 and 168 (7 days)."
    min: 24
    max: 168
    default: 24
    required: true

  stream_pool_name:
    type: string
    title: "Stream Pool Name"
    description: "(Updatable) The name of the stream pool. Avoid entering confidential information. Example: MyStreamPool"
    default: "MyStreamPool"
    required: true

  stream_pool_kafka_settings_auto_create_topics_enable:
    type: boolean
    title: "Auto Create Topics"
    description: "(Updatable) Enable auto creation of topic on the server."
    default: true
    required: true

  stream_pool_kafka_settings_log_retention_hours:
    type: int
    title: "Log Retention Hours"
    description: "(Updatable) The number of hours to keep a log file before deleting it (in hours)."
    min: 1
    default: 24
    required: true

  stream_pool_kafka_settings_num_partitions:
    type: int
    title: "Log Partitions"
    description: "(Updatable) The default number of log partitions per topic."
    min: 1
    default: 1
    required: true

